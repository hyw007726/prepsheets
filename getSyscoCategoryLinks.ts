import * as functions from 'firebase-functions';
import puppeteer from 'puppeteer';

export const getSyscoCategoryLinks= functions
  .region('europe-west2')
  .https.onRequest(async (req, res) => {
     
    (async () => {
      const browser = await puppeteer.launch();
      const page = await browser.newPage();
      await page.goto('https://order.syscoireland.com/');
    await page.waitForTimeout(2000);
    await page.evaluate(() =>{
      const el= <HTMLElement>document.getElementsByClassName('action nav-toggle')[0];
     el.click();
    });
    await page.waitForTimeout(2000);
    
  const list = await page.evaluateHandle(() =>document.querySelectorAll("[class='ui-corner-all']"));
  const result = await page.evaluateHandle((list)=>{
    var str=""
    list.forEach((ele)=>{
      var href=ele.getAttribute("href");
      // var category=href?.split("/")[7];
      str+=href+",";
    })
    return str;
  },list)
      // const testConst=await page.content();
      // await console.log(testConst);
      await browser.close();
      // await res.send(testConst);
      return result.jsonValue();
    })().then((x)=>{
      // var arr = (x as string).split(",");
      res.json(x);
    }).catch(err => err);

  
  });



    
// export const test2 = functions
//   .runWith({
//     timeoutSeconds: 540,
//     memory: '1GB',
//   })
//   .region('europe-west2')
  // .https.onRequest(async (req, res) => {
  //   console.log(req);
  //   res.set('Access-Control-Allow-Origin', '*');
  //   res.set(
  //     "Access-Control-Allow-Headers",
  //     "Origin, X-Requested-With, Content-Type, Accept"
  //   );
  //   res.setHeader('Content-Type', 'application/json')
  //   res.status(200).send(JSON.stringify({"a":1}));
  // }
  // )


//  var str="https://order.syscoireland.com/catalog/category/view/s/beef/id/10796/https://order.syscoireland.com/catalog/category/view/s/chicken/id/10583/https://order.syscoireland.com/catalog/category/view/s/bacon-rashers/id/10769/https://order.syscoireland.com/catalog/category/view/s/lamb/id/10799/https://order.syscoireland.com/catalog/category/view/s/sausages/id/10730/https://order.syscoireland.com/catalog/category/view/s/pork/id/10745/https://order.syscoireland.com/catalog/category/view/s/turkey/id/10526/https://order.syscoireland.com/catalog/category/view/s/duck/id/10835/https://order.syscoireland.com/catalog/category/view/s/puddings/id/10766/https://order.syscoireland.com/catalog/category/view/s/veal/id/10838/https://order.syscoireland.com/catalog/category/view/s/game/id/10829/https://order.syscoireland.com/catalog/category/view/s/other-poultry/id/10820/https://order.syscoireland.com/catalog/category/view/s/fresh-vegetables/id/10718/https://order.syscoireland.com/catalog/category/view/s/fresh-fruit/id/10754/https://order.syscoireland.com/catalog/category/view/s/potato/id/10544/https://order.syscoireland.com/catalog/category/view/s/frozen-vegetables/id/10517/https://order.syscoireland.com/catalog/category/view/s/fries/id/10724/https://order.syscoireland.com/catalog/category/view/s/prepared-veg/id/10481/https://order.syscoireland.com/catalog/category/view/s/frozen-fruit/id/10826/https://order.syscoireland.com/catalog/category/view/s/fruit-veg-herbs/id/10760/https://order.syscoireland.com/catalog/category/view/s/prepared-fruit/id/10607/https://order.syscoireland.com/catalog/category/view/s/fruit-veg-dried-fruit/id/10757/https://order.syscoireland.com/catalog/category/view/s/fruit-veg-other/id/10841/https://order.syscoireland.com/catalog/category/view/s/speciality/id/10895/https://order.syscoireland.com/catalog/category/view/s/cheese/id/10559/https://order.syscoireland.com/catalog/category/view/s/milk/id/10670/https://order.syscoireland.com/catalog/category/view/s/butter-spreads/id/10751/https://order.syscoireland.com/catalog/category/view/s/eggs/id/10763/https://order.syscoireland.com/catalog/category/view/s/yoghurt/id/10727/https://order.syscoireland.com/catalog/category/view/s/cream/id/10643/https://order.syscoireland.com/catalog/category/view/s/artisan-cheese/id/10778/https://order.syscoireland.com/catalog/category/view/s/everyday-essentials/id/10943/https://order.syscoireland.com/catalog/category/view/s/dairy-milk-eggs/id/10775/https://order.syscoireland.com/catalog/category/view/s/buttermilk-sour/id/10802/https://order.syscoireland.com/catalog/category/view/s/health-wellness/id/11439/https://order.syscoireland.com/catalog/category/view/s/cereal/id/10868/https://order.syscoireland.com/catalog/category/view/s/cheese-dairy-eggs-snacks/id/10937/https://order.syscoireland.com/catalog/category/view/s/protein/id/10949/https://order.syscoireland.com/cheese-dairy-eggs/frozen-foods.htmlhttps://order.syscoireland.com/catalog/category/view/s/frozen-fish/id/10550/https://order.syscoireland.com/catalog/category/view/s/fresh-fish/id/10817/https://order.syscoireland.com/catalog/category/view/s/delicatessen/id/10682/https://order.syscoireland.com/catalog/category/view/s/salmon/id/10901/https://order.syscoireland.com/catalog/category/view/s/r-i-f-fish/id/23381/https://order.syscoireland.com/catalog/category/view/s/deli-ready-meals-other/id/10733/https://order.syscoireland.com/catalog/category/view/s/cooked-meat/id/10535/https://order.syscoireland.com/catalog/category/view/s/pizza/id/10613/https://order.syscoireland.com/catalog/category/view/s/cooked-poultry/id/10580/https://order.syscoireland.com/catalog/category/view/s/hot-deli/id/10742/https://order.syscoireland.com/catalog/category/view/s/ready-meals/id/10382/https://order.syscoireland.com/catalog/category/view/s/canape-finger-food/id/10721/https://order.syscoireland.com/catalog/category/view/s/antipasti/id/10706/https://order.syscoireland.com/catalog/category/view/s/charcuterie/id/10859/https://order.syscoireland.com/catalog/category/view/s/salads-fillings/id/10619/https://order.syscoireland.com/catalog/category/view/s/soups/id/10592/https://order.syscoireland.com/catalog/category/view/s/pate-terrine/id/10889/https://order.syscoireland.com/catalog/category/view/s/bread/id/10484/https://order.syscoireland.com/catalog/category/view/s/pastry-frozen/id/10490/https://order.syscoireland.com/catalog/category/view/s/pastry/id/10787/https://order.syscoireland.com/catalog/category/view/s/biscuits-cookies-bars/id/10388/https://order.syscoireland.com/catalog/category/view/s/cookies-doughnuts-muffins/id/10475/https://order.syscoireland.com/catalog/category/view/s/gluten-free/id/10883/https://order.syscoireland.com/catalog/category/view/s/croissants/id/10772/https://order.syscoireland.com/catalog/category/view/s/scones/id/10715/https://order.syscoireland.com/catalog/category/view/s/bakery-savoury-other/id/10736/https://order.syscoireland.com/catalog/category/view/s/cakes-buns-cupcakes/id/10610/https://order.syscoireland.com/catalog/category/view/s/baskets-nests/id/10805/https://order.syscoireland.com/catalog/category/view/s/speciality-breads/id/22491/https://order.syscoireland.com/catalog/category/view/s/crackers/id/10622/https://order.syscoireland.com/catalog/category/view/s/viennoiseries/id/10739/https://order.syscoireland.com/catalog/category/view/s/scones-crumpets/id/10965/https://order.syscoireland.com/catalog/category/view/s/sweet-pastry/id/11427/https://order.syscoireland.com/catalog/category/view/s/sandwich-deli/id/11403/https://order.syscoireland.com/catalog/category/view/s/bakery-savoury-confectionery/id/11385/https://order.syscoireland.com/catalog/category/view/s/pies-tarts/id/10790/https://order.syscoireland.com/catalog/category/view/s/savoury-canape/id/25103/https://order.syscoireland.com/catalog/category/view/s/bagels/id/25185/https://order.syscoireland.com/catalog/category/view/s/individual-mini-desserts/id/25191/https://order.syscoireland.com/catalog/category/view/s/cereals/id/10439/https://order.syscoireland.com/catalog/category/view/s/canned-veg/id/10403/https://order.syscoireland.com/catalog/category/view/s/spices-herbs/id/10487/https://order.syscoireland.com/catalog/category/view/s/oil/id/10427/https://order.syscoireland.com/catalog/category/view/s/pasta/id/10661/https://order.syscoireland.com/catalog/category/view/s/canned-tomato/id/10655/https://order.syscoireland.com/catalog/category/view/s/jam-marmalade/id/10436/https://order.syscoireland.com/catalog/category/view/s/canned-dried-foods-dried-fruit/id/10406/https://order.syscoireland.com/catalog/category/view/s/sugar/id/10667/https://order.syscoireland.com/catalog/category/view/s/topping/id/10460/https://order.syscoireland.com/catalog/category/view/s/rice/id/10562/https://order.syscoireland.com/catalog/category/view/s/canned-fruit/id/10400/https://order.syscoireland.com/catalog/category/view/s/canned-dried-foods-other/id/10793/https://order.syscoireland.com/catalog/category/view/s/honey/id/10604/https://order.syscoireland.com/catalog/category/view/s/canned-dried-foods-nuts/id/10640/https://order.syscoireland.com/catalog/category/view/s/vinegar/id/10463/https://order.syscoireland.com/catalog/category/view/s/pulses-seeds/id/10511/https://order.syscoireland.com/catalog/category/view/s/fruit-juices/id/10418/https://order.syscoireland.com/catalog/category/view/s/hot-cold-beverages-soft-drinks/id/10448/https://order.syscoireland.com/catalog/category/view/s/water/id/10748/https://order.syscoireland.com/catalog/category/view/s/coffee/id/10472/https://order.syscoireland.com/catalog/category/view/s/soft-drinks/id/10959/https://order.syscoireland.com/catalog/category/view/s/tea/id/10589/https://order.syscoireland.com/catalog/category/view/s/syrup/id/10565/https://order.syscoireland.com/catalog/category/view/s/hot-chocolate/id/10649/https://order.syscoireland.com/catalog/category/view/s/smoothies/id/10646/https://order.syscoireland.com/catalog/category/view/s/hot-cold-beverages-other/id/10568/https://order.syscoireland.com/catalog/category/view/s/functional-drinks/id/10616/https://order.syscoireland.com/catalog/category/view/s/ice-cream/id/10664/https://order.syscoireland.com/catalog/category/view/s/frozen-cakes/id/10541/https://order.syscoireland.com/catalog/category/view/s/tray-bakes/id/10514/https://order.syscoireland.com/catalog/category/view/s/mini-desserts/id/10832/https://order.syscoireland.com/catalog/category/view/s/tarts-pies/id/10553/https://order.syscoireland.com/catalog/category/view/s/flavoured-toppings/id/10520/https://order.syscoireland.com/catalog/category/view/s/desserts-cakes-other/id/10469/https://order.syscoireland.com/catalog/category/view/s/ice-cream-desserts/id/10454/https://order.syscoireland.com/catalog/category/view/s/sorbets/id/10694/https://order.syscoireland.com/catalog/category/view/s/dessert-sauce/id/10457/https://order.syscoireland.com/catalog/category/view/s/ice-cream-decoration/id/10808/https://order.syscoireland.com/catalog/category/view/s/banqueting-slabs/id/10916/https://order.syscoireland.com/catalog/category/view/s/quick-service-product/id/10874/https://order.syscoireland.com/catalog/category/view/s/fresh-cakes/id/10586/https://order.syscoireland.com/catalog/category/view/s/ice-cream-cones/id/10814/https://order.syscoireland.com/catalog/category/view/s/gluten-free-cake/id/23369/https://order.syscoireland.com/catalog/category/view/s/yoghurt-frozen/id/10598/https://order.syscoireland.com/catalog/category/view/s/petits-fours/id/10919/https://order.syscoireland.com/catalog/category/view/s/disposables/id/10508/https://order.syscoireland.com/catalog/category/view/s/takeaway/id/10847/https://order.syscoireland.com/catalog/category/view/s/hot-cups-lids/id/10850/https://order.syscoireland.com/catalog/category/view/s/other-packaging/id/10862/https://order.syscoireland.com/catalog/category/view/s/cold-cups-lids/id/10844/https://order.syscoireland.com/catalog/category/view/s/bakery/id/10625/https://order.syscoireland.com/catalog/category/view/s/deli/id/10856/https://order.syscoireland.com/catalog/category/view/s/wrapping-systems/id/10628/https://order.syscoireland.com/catalog/category/view/s/mayonnaise/id/10442/https://order.syscoireland.com/catalog/category/view/s/condiments-sauces/id/10781/https://order.syscoireland.com/catalog/category/view/s/ketchup/id/10697/https://order.syscoireland.com/catalog/category/view/s/relish-chutneys/id/10433/https://order.syscoireland.com/catalog/category/view/s/mustards-pestos/id/10784/https://order.syscoireland.com/catalog/category/view/s/dressing/id/10712/https://order.syscoireland.com/catalog/category/view/s/condiments-other/id/10688/https://order.syscoireland.com/catalog/category/view/s/flour-yeast/id/10412/https://order.syscoireland.com/catalog/category/view/s/chocolate/id/10658/https://order.syscoireland.com/catalog/category/view/s/dessert-ingredients/id/10631/https://order.syscoireland.com/catalog/category/view/s/sugars/id/10601/https://order.syscoireland.com/catalog/category/view/s/denatured-alcohol/id/10913/https://order.syscoireland.com/catalog/category/view/s/purees-fresh-fruit/id/10685/https://order.syscoireland.com/catalog/category/view/s/purees-frozen/id/10823/https://order.syscoireland.com/new-product/fresh-and-frozen-produce.htmlhttps://order.syscoireland.com/new-product/seafood.htmlhttps://order.syscoireland.com/new-product/centre-plate.htmlhttps://order.syscoireland.com/new-product/bakery-and-dessert.htmlhttps://order.syscoireland.com/new-product/dairy.htmlhttps://order.syscoireland.com/new-product/canned-and-dried.htmlhttps://order.syscoireland.com/new-product/beverage-and-impulse.htmlhttps://order.syscoireland.com/new-product/deli-and-ready-meals.htmlhttps://order.syscoireland.com/new-product/meat-free.htmlhttps://order.syscoireland.com/new-product/catering-essentials.htmlhttps://order.syscoireland.com/world-food-irl/world-food-canned-and-dried.htmlhttps://order.syscoireland.com/world-food-irl/world-food-condiments.htmlhttps://order.syscoireland.com/world-food-irl/world-food-cooking-sauces.htmlhttps://order.syscoireland.com/world-food-irl/world-food-cooking-ingredients.htmlhttps://order.syscoireland.com/world-food-irl/world-food-bakery-and-dessert.htmlhttps://order.syscoireland.com/world-food-irl/world-food-deli-food.htmlhttps://order.syscoireland.com/world-food-irl/world-food-cleaning-and-disposables.htmlhttps://order.syscoireland.com/world-food-irl/world-food-meat-and-poultry.htmlhttps://order.syscoireland.com/world-food-irl/world-food-fish-and-shellfish.htmlhttps://order.syscoireland.com/world-food-irl/world-food-frozen.htmlhttps://order.syscoireland.com/catalog/category/view/s/stocks-sauces-sauces/id/10424/https://order.syscoireland.com/catalog/category/view/s/bouillon/id/10445/https://order.syscoireland.com/catalog/category/view/s/stocks-sauces-other/id/10466/https://order.syscoireland.com/catalog/category/view/s/marinade-glazes/id/10595/https://order.syscoireland.com/catalog/category/view/s/bars/id/10502/https://order.syscoireland.com/catalog/category/view/s/crisps/id/10532/https://order.syscoireland.com/catalog/category/view/s/confectionery-snacks/id/10703/https://order.syscoireland.com/catalog/category/view/s/sweets/id/10529/https://order.syscoireland.com/catalog/category/view/s/tortilla/id/10700/https://order.syscoireland.com/catalog/category/view/s/confectionery-nuts/id/10394/https://order.syscoireland.com/catalog/category/view/s/confectionery-other/id/10538/https://order.syscoireland.com/catalog/category/view/s/gum/id/10871/https://order.syscoireland.com/catalog/category/view/s/mints/id/23358/https://order.syscoireland.com/catalog/category/view/s/easter/id/10946/https://order.syscoireland.com/catalog/category/view/s/savoury-snacks/id/23364/https://order.syscoireland.com/catalog/category/view/s/popcorn/id/23375/https://order.syscoireland.com/catalog/category/view/s/healthier-snacks/id/24372/https://order.syscoireland.com/catalog/category/view/s/cleaning/id/10496/https://order.syscoireland.com/catalog/category/view/s/hygiene/id/10499/https://order.syscoireland.com/catalog/category/view/s/janitorial-safety/id/10679/https://order.syscoireland.com/catalog/category/view/s/cleaning-hygiene-other/id/10886/https://order.syscoireland.com/catalog/category/view/s/guest-amenities/id/10928/https://order.syscoireland.com/catalog/category/view/s/kitchen-ware/id/10577/https://order.syscoireland.com/catalog/category/view/s/catering-essentials-other/id/10574/https://order.syscoireland.com/catalog/category/view/s/baking-essentials/id/10898/https://order.syscoireland.com/catalog/category/view/s/crockery/id/10853/https://order.syscoireland.com/catalog/category/view/s/cutlery/id/10865/https://order.syscoireland.com/catalog/category/view/s/glassware/id/10910/https://order.syscoireland.com/catalog/category/view/s/table-top/id/10652/https://order.syscoireland.com/catalog/category/view/s/bar-accessories/id/10925/https://order.syscoireland.com/catalog/category/view/s/cooking-wine/id/10676/https://order.syscoireland.com/catalog/category/view/s/wine/id/10892/https://order.syscoireland.com/catalog/category/view/s/alcohol-other/id/10904/https://order.syscoireland.com/catalog/category/view/s/spirits/id/10907/https://order.syscoireland.com/catalog/category/view/s/beer/id/10934/https://order.syscoireland.com/catalog/category/view/s/non-alcoholic/id/10940/https://order.syscoireland.com/catalog/category/view/s/port/id/10953/https://order.syscoireland.com/catalog/category/view/s/white-wine/id/11043/https://order.syscoireland.com/catalog/category/view/s/red-wine/id/11046/https://order.syscoireland.com/catalog/category/view/s/rose-wine/id/11049/https://order.syscoireland.com/catalog/category/view/s/champagne/id/11052/https://order.syscoireland.com/catalog/category/view/s/meat-alternatives/id/10691/https://order.syscoireland.com/catalog/category/view/s/soya-milk/id/10637/https://order.syscoireland.com/catalog/category/view/s/protein-powders/id/10931/"
  
//  str.split(",").map((a)=>{
//     var arr=a.split(":");
//     arr[0]="\""+arr[0]+"\"";
//     return arr.join()
//   })
